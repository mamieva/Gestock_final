<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<script>
    var AWSLBehaviors = AWSLBehaviors || {};

    (function () {
        AWSLBehaviors.ListVaadinBehavior = {
            properties: {
                oname: {
                    type: String,
                },
                filterName: {
                    type: String,
                    value: ""
                },
                ajaxlist: {
                    type: Object
                },
                items: {
                    type: Array,
                },
                titleSearch: {
                    type: String
                },
                lastTitle: {
                    type: String
                },
                toserver: {
                    type: Object,
                    value: function () {
                        var obj = {
                            oname: "",
                            filterName: "",
                            sortIndex: 0,
                            sortDir: "asc",
                            dofastsearch: false,
                            fastsearch: "",
                            data: {},
                            topRecords: 100,
                            first: true
                        };

                        return obj;
                    }
                },
                fastsearch: {
                    type: String
                },
                itemsCount: {
                    type: Number,
                    value: 0
                },
                serverSideSorting: {
                    type: Boolean,
                    value: false
                }
            },
            spinner: null,
            wasAttached: false,
            firstResponse: false,
            refreshPending: false,

            insertSpinner: function()
            {
                if (this.getItemsList().parentNode === this) {
                    if (Polymer.dom(this).childNodes.length == 0) {
                        this.async(this.insertSpinner, 100);
                    }
                    else {
                        Polymer.dom(this).insertBefore(this.spinner, Polymer.dom(this).childNodes[0]);
                    }
                }
                else {
                    Polymer.dom(this.getItemsList().parentNode).insertBefore(this.spinner, this.getItemsList());
                }
            },
            attached: function () {
                if (this.wasAttached) {
                    return;
                }
                this.wasAttached = true;

                this.spinner = document.createElement('paper-spinner');

                this.spinner.style.position= 'absolute';
                this.spinner.style.zIndex= 100000;
                this.spinner.style.left = '50%';
                this.spinner.style.top = '150px';
                //this.spinner.hidden = true;

                this.insertSpinner();

                this.spinner.active = true;
                this.spinner.hidden = false;



                // this.ajaxlist = document.createElement('iron-ajax');
                //
                // this.ajaxlist.method = 'POST';
                // this.ajaxlist.contentType = 'application/json';
                //
                // this.ajaxlist.addEventListener('response', this._handleResponse.bind(this));
                // this.ajaxlist.addEventListener('error', this._handleError.bind(this));
                //
                // this.ajaxlist.url = "https://jsonplaceholder.typicode.com/users";
                // this.toserver.oname = this.oname;
                //
                // this.getItemsList().reallythis = this;
                // this.getItemsList().addEventListener('selected-items-changed', this._selectedItemChanged);
                // this.getItemsList().addEventListener('sort-order-changed', this._sortOrderChanged);
                //
                // if (this.getItemsList().awslcustomized === undefined) {
                //     this.getItemsList().awslcustomized = true;
                //     this.customizeItemsList();
                // }
                //
                // if (this.refreshPending && this.getFilter() != null) {
                //     if (this.getFilter().thefilter == null) {
                //         this.refreshPending = true;
                //     }
                //     else {
                //         this.refresh();
                //     }
                // }
            },
            _selectedItemChangedNotify: function(key, select) {
            },
            getItemsList: function () {
                return null;
            },
            getFilter: function () {
                return null;
            },
            getListToolbar: function () {
                return null;
            },
            customizeItemsList: function () {
            },
            _openFilter: function () {
                this.getFilter()._openFilter();
            }
}})();
</script>
